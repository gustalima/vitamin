#!/bin/bash
echo 'This installer will set up ViTaMIn and all its dependencies'
echo "ViTaMIn needs to install csh, biopython, matplotlib, pymol and fort77 from Ubuntu repository."
echo 'Modeller key is not provided and you may have to request one at https://salilab.org/modeller/registration.html'
sleep 2s


wget https://salilab.org/modeller/9.16/modeller_9.16-1_amd64.deb

echo -n 'If you already have a license, please insert it now:'
read modkey

echo 'Installing MODELLER'
sudo env KEY_MODELLER=$modkey dpkg -i modeller_9.16-1_amd64.deb && rm modeller_9.16-1_amd64.deb



sudo apt-get update
sudo apt-get install csh python-biopython python-gobject python-gi-cairo python-matplotlib pymol lsyncd fort77 -y

mkdir $HOME/Vitamin

mv procheck.tar.gz $HOME/Vitamin

mv Vitamin.tar.gz $HOME/Vitamin

cd $HOME/Vitamin
tar -xvf Vitamin.tar.gz && rm Vitamin.tar.gz

mv procheck.tar.gz src/
cd src/
tar -xvf procheck.tar.gz && rm procheck.tar.gz
cd procheck

chmod +x procomp.scr
./procomp.scr

if grep -Fq 'alias procheck' ~/.bashrc
then
echo 'Procheck already in bash. Skipping this step.'
else
echo "export VITAMIN_HOME='$HOME/Vitamin/'" >> ~/.bashrc
echo "alias procheck='$VITAMIN_HOME/src/procheck/procheck.scr'" >> ~/.bashrc
echo "export prodir='$VITAMIN_HOME/src/procheck'" >> ~/.bashrc
fi


cd $HOME/Vitamin
bash
